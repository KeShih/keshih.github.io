<!doctype html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The Art Gallery Guardian">
    <meta name="author" content="Chao Xu">
    <meta name="google-site-verification" content="YE2oeW4OwVOPdVVfdpYIakOuD0A2Qo80W_sUbMJDGok" />
    <meta name="referrer" content="origin">
    <title>Rectangles in point set</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          var macros={
                  "\\C":"\\mathbb{C}",
                  "\\F":"\\mathbb{F}",
                  "\\e": "\\varepsilon",
                  "\\eps": "\\varepsilon",
                  "\\argmin": "\\DOTSB\\mathop{\\operatorname{arg\\,min}}\\limits",
                  "\\argmax": "\\DOTSB\\mathop{\\operatorname{arg\\,max}}\\limits",
                  "\\mex": "\\mathop{\\operatorname{mex}}",
                  "\\lcm": "\\mathop{\\operatorname{lcm}}",
                  "\\dist": "\\mathop{\\operatorname{dist}}",
                  "\\bigtriangleright": "{\\mathop{\\Large \\triangleright}}",
                  "\\bigtriangleleft": "{\\mathop{\\Large \\triangleleft}}",
                  '\\set':'\\left\\{ #1 \\right\\}',
                  '\\floor':'\\left\\lfloor #1 \\right\\rfloor',
                  '\\ceil':'\\left\\lceil #1 \\right\\rceil',
                  '\\abs':'\\left\\| #1 \\right\\|'
                  }
        var mathElements = document.getElementsByClassName("math");
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") { katex.render(texText.data, mathElements[i], { displayMode: mathElements[i].classList.contains("display"), throwOnError: false, macros:macros} );
        }}});
    </script>

  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
  <link rel="stylesheet" href="/css/default.css" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/blog.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml" title="RSS"
      href="https://chaoxuprime.com/rss.xml">
  </head>
  <body>
    <header class="hide-on-print">
        <div id="site-title">
            <a href="/blog.html">The Art Gallery Guardian</a>
        </div>
    </header>
    <nav class="hide-on-print">
      <ul>
        <li><a href="/">About</a></li>
        <li><a href="/blog.html">Blog</a></li>
        <li><a href="/files/cv.pdf">CV</a></li>
        <li><a href="/tools.html">Tools</a></li>
      </ul>
    </nav>
    <main>
      <article>
        <h1 id="article-title">Rectangles in point set</h1>
        <br />
<div>
<section class="theorem-environment Problem" id="Problem-1">
<span class="theorem-header"><span class="type">Problem</span><span class="index">1</span></span>
<p>Given <span class="math inline">n</span> points in the plane <span class="math inline">P</span>, find if any <span class="math inline">4</span> of them are the vertices of some axis-aligned rectangle.</p>
</section>
<p>The idea is we guess the left vertical segment of the rectangle, and see what would be the right vertical segment. If we pick an left vertical line <span class="math inline">l</span>, and then for each <span class="math inline">(x,y)\in l\cap P</span>, we consider all the points with the same <span class="math inline">y</span> coordinate and to the right of <span class="math inline">x</span>, and add a counter to the vertical lines that contains it. This can be done in linear time with respect to number of vertices with the same <span class="math inline">y</span> coordinate if one already builds a data structure before hand. If any counter become <span class="math inline">2</span>, then we are done.</p>
<p>It is a <span class="math inline">O(n^2)</span> time algorithm, since the time it takes is at most <span class="math inline">O(n)</span> to guess each left vertical segment. One could, however analyze this algorithm better, and realize the time is actually <span class="math inline">O(ln)</span>, where <span class="math inline">l</span> is the maximum number of points on a horizontal line. Indeed, we look at a horizontal line that contain <span class="math inline">l</span> points, and realize for each point on the horizontal line, we need to increment a counter at most <span class="math inline">l</span> times.</p>
<p>We can also solve the problem in <span class="math inline">O(t^2+n)</span> time, where <span class="math inline">t</span> is the number of vertical lines. Note since we can stop as soon as a counter become <span class="math inline">2</span>. The number of counter we will increase is at most <span class="math inline">t^2</span>. Indeed, the counter depend only one two vertical lines.</p>
<p>There is an <span class="math inline">O(n^{3/2})</span> algorithm <span class="citation" data-cites="vanKreveldD91">[<a href="#ref-vanKreveldD91">1</a>]</span>, using this <span class="math inline">O(n^2)</span> algorithm as subroutine.</p>
<p>We consider the set of vertical lines that contains at least <span class="math inline">2</span> points. This give us two set of vertical lines, <span class="math inline">S</span> are the lines with at most <span class="math inline">\sqrt{n}</span> points and <span class="math inline">L</span> are the lines contain at least <span class="math inline">\sqrt{n}+1</span> lines.</p>
<p>There are 3 possibilities. There is a rectangle with two sides contained in <span class="math inline">S</span>, or one side in <span class="math inline">S</span> one in <span class="math inline">L</span>, or both in <span class="math inline">L</span>.</p>
<p>For the first case, just use our <span class="math inline">O(ln)</span> algorithm, which gives us <span class="math inline">O(n^{3/2})</span> time.</p>
<p>For the second case, consider we pick one line in <span class="math inline">S</span> and the union of all the points in the lines in <span class="math inline">L</span>. For each point in <span class="math inline">S</span>, we will find if this point is in some line in <span class="math inline">L</span>, if it is, we increment a counter for that line. We would increment at most <span class="math inline">\sqrt{n}</span> counters. The running time is therefore <span class="math inline">\sum_{l\in S} |l\cap P|(\log n + \sqrt{n}) = O(n^{3/2})</span>.</p>
<p>Once we are done with the first two case, consider remove all the points lying on the small lines. Now we only have large lines. Since there are at most <span class="math inline">\sqrt{n}</span> large lines, we can rotate the plane and run the algorithm again, but this time, we know all the lines are small.</p>
<p>As noted in <span class="citation" data-cites="AlonYZ97">[<a href="#ref-AlonYZ97">2</a>]</span>, rectangle finding problem can be reduced to finding a <span class="math inline">C_4</span> in a bipartite graph. The vertices are <span class="math inline">X=\set{x|(x,y)\in P}</span> and <span class="math inline">Y=\set{y|(x,y)\in P}</span>, and the edges are <span class="math inline">P</span>. So this is a nice interaction with graph theory. In the same article, some stronger bounds were established. First, if the graph have <a href="https://en.wikipedia.org/wiki/Degeneracy_(graph_theory)">degeneracy</a> <span class="math inline">d</span>, the running is <span class="math inline">O(md)</span>. They used the fact and lead to finding a <span class="math inline">C_4</span> takes <span class="math inline">O(m^{4/3})</span> time <span class="citation" data-cites="AlonYZ97">[<a href="#ref-AlonYZ97">2</a>]</span>.</p>
<p>We briefly mention how this is done.</p>
<p>First, it is known that if <span class="math inline">m \geq c n^{1/2}</span>, then there exists a <span class="math inline">C_4</span>. If <span class="math inline">d\geq c n^{3/2}</span>, then one can find a subgraph that has degree at least <span class="math inline">d</span> in <span class="math inline">O(m)</span> time. Note this implies in the subgraph, there exists a <span class="math inline">C_4</span>, which there is a particular algorithm to solve for it.</p>
<h1 id="bibliography" class="unnumbered">References</h1>
<div id="refs" class="references">
<div id="ref-vanKreveldD91">
<p>[1] M.J. van Kreveld, M.T. De Berg, <strong>Finding squares and rectangles in sets of points</strong>, BIT Numerical Mathematics. 31 (1991) 202–219 <a href="https://doi.org/10.1007/BF01931281">10.1007/BF01931281</a>.</p>
</div>
<div id="ref-AlonYZ97">
<p>[2] N. Alon, R. Yuster, U. Zwick, <strong>Finding and counting given length cycles</strong>, Algorithmica. 17 (1997) 209–223 <a href="https://doi.org/10.1007/BF02523189">10.1007/BF02523189</a>.</p>
</div>
</div>

</div>
<div class="hide-on-print">
    <div class="info">Posted by <a href="https://chaoxuprime.com">Chao Xu</a> on 2015-02-02. </div>
    <div class="info">Tags: classical, algorithm, computational geometry, graph theory.</div>

</div>
      </article>
    </main>
    <footer class="hide-on-print">© 2010 - <time><script>document.write(new Date().getFullYear())</script></time> <a href="https://chaoxuprime.com">Chao Xu</a>. Licensed under <a href="http://www.wtfpl.net/txt/copying/">WTFPL v2</a> unless otherwise specified. <a href="/README.html">Blog README</a>.</footer>
    <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
    <script>
      (function(f, a, t, h, o, m){
        a[h]=a[h]||function(){
          (a[h].q=a[h].q||[]).push(arguments)
        };
        o=f.createElement('script'),
        m=f.getElementsByTagName('script')[0];
        o.async=1; o.src=t; o.id='fathom-script';
        m.parentNode.insertBefore(o,m)
      })(document, window, '//ec2-52-91-103-22.compute-1.amazonaws.com:8080/tracker.js', 'fathom');
      fathom('set', 'siteId', 'WXDOF');
      fathom('trackPageview');
    </script>
    <!-- / Fathom -->
  </body>
</html>
