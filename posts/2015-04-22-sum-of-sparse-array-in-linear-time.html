<!doctype html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The Art Gallery Guardian">
    <meta name="author" content="Chao Xu">
    <meta name="google-site-verification" content="YE2oeW4OwVOPdVVfdpYIakOuD0A2Qo80W_sUbMJDGok" />
    <meta name="referrer" content="origin">
    <title>Sum of sparse array in linear time</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          var macros={
                  "\\C":"\\mathbb{C}",
                  "\\F":"\\mathbb{F}",
                  "\\e": "\\varepsilon",
                  "\\eps": "\\varepsilon",
                  "\\argmin": "\\DOTSB\\mathop{\\operatorname{arg\\,min}}\\limits",
                  "\\argmax": "\\DOTSB\\mathop{\\operatorname{arg\\,max}}\\limits",
                  "\\mex": "\\mathop{\\operatorname{mex}}",
                  "\\lcm": "\\mathop{\\operatorname{lcm}}",
                  "\\dist": "\\mathop{\\operatorname{dist}}",
                  "\\bigtriangleright": "{\\mathop{\\Large \\triangleright}}",
                  "\\bigtriangleleft": "{\\mathop{\\Large \\triangleleft}}",
                  '\\set':'\\left\\{ #1 \\right\\}',
                  '\\floor':'\\left\\lfloor #1 \\right\\rfloor',
                  '\\ceil':'\\left\\lceil #1 \\right\\rceil',
                  '\\abs':'\\left\\| #1 \\right\\|'
                  }
        var mathElements = document.getElementsByClassName("math");
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") { katex.render(texText.data, mathElements[i], { displayMode: mathElements[i].classList.contains("display"), throwOnError: false, macros:macros} );
        }}});
    </script>
  <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
  <script>
  if(window.location.hostname === "chaoxuprime.com"){
    (function(f, a, t, h, o, m){
      a[h]=a[h]||function(){
        (a[h].q=a[h].q||[]).push(arguments)
      };
      o=f.createElement('script'),
      m=f.getElementsByTagName('script')[0];
      o.async=1; o.src=t; o.id='fathom-script';
      m.parentNode.insertBefore(o,m)
    })(document, window, '//track.chaoxuprime.com/tracker.js', 'fathom');
    fathom('set', 'siteId', 'DNRQY');
    fathom('trackPageview');
  }
  </script>
  <!-- / Fathom -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4171915-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-4171915-2');
  </script>

  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
  <link rel="stylesheet" href="/css/default.css" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/blog.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml" title="RSS"
      href="https://chaoxuprime.com/rss.xml">
  </head>
  <body>
    <header class="hide-on-print">
        <div id="site-title">
            <a href="/blog.html">The Art Gallery Guardian</a>
        </div>
    </header>
    <nav class="hide-on-print">
      <ul>
        <li><a href="/">About</a></li>
        <li><a href="/blog.html">Blog</a></li>
        <li><a href="/files/cv.pdf">CV</a></li>
        <li><a href="/tools.html">Tools</a></li>
      </ul>
    </nav>
    <main>
      <article>
        <h1 id="article-title">Sum of sparse array in linear time</h1>
        <br />
<div>
<p>Let <span class="math inline">\vec{n}=(n_1,\ldots,n_d)</span>. Define <span class="math inline">\vec{x}\mod \vec{n} = (x_1 \mod n_1,\ldots,x_d\mod n_d)</span>. We want to represent an <span class="math inline">d</span>-dimensional array. Assume <span class="math inline">A</span> and <span class="math inline">B</span> are both <span class="math inline">d</span>-dimensional arrays of size <span class="math inline">\vec{n}</span> and one have <span class="math inline">m</span> non-zero elements one have <span class="math inline">m&#39;</span> non-zero elements. The following operations should be supported.</p>
<ol type="1">
<li><span class="math inline">circshift(A,\vec{r})</span> creates a new sparse array <span class="math inline">C</span>, such that <span class="math inline">C((\vec{i}+\vec{r}) \mod \vec{n})=A(\vec{i})</span>. This is the <a href="http://www.mathworks.com/help/matlab/ref/circshift.html">circshift operation</a> in matlab. Running time should be <span class="math inline">O(m)</span>.</li>
<li>Similarly, we can define <span class="math inline">shift(A,\vec{t})</span>, such that <span class="math inline">C(\vec{i}+\vec{t})=A(\vec{i})</span>, if <span class="math inline">\vec{i}+\vec{t}</span> is outside the range, we have <span class="math inline">0</span> instead.</li>
<li><span class="math inline">A+B</span> returns a sparse array <span class="math inline">C</span> such that <span class="math inline">C(\vec{i})=A(\vec{i})+B(\vec{i})</span> in <span class="math inline">O(m+m&#39;)</span> time.</li>
<li><span class="math inline">elements(A)</span> output all elements with associated coordinates in <span class="math inline">A</span> in <span class="math inline">O(m)</span> time.</li>
<li><span class="math inline">initialize(x,\vec{n})</span> create a new sparse array with size <span class="math inline">\vec{n}</span> and one element <span class="math inline">x</span> initialized at <span class="math inline">\vec{0}</span> position.</li>
</ol>
<p>We create a sparse list with <span class="math inline">d-1</span> dimension slices, and the lower dimension slices can be handled inductively. All we need to do is to implement sparse list. The list should store the position and value pairs ordered by position. Sum can be done with a merge operation. circshift go though all elements one by one and update the position, and then rotate the list so the smallest position is in the beginning.</p>
<p>This data structure can be useful output sensitive dynamic programming problems. For example, multidimensional subset sum have a simple recursive solution.</p>
<ol type="1">
<li>Input <span class="math inline">S=\{s_1,\ldots,s_n\}</span></li>
<li><span class="math inline">X\gets \{0\}</span>.</li>
<li>For <span class="math inline">i</span> from <span class="math inline">1</span> to <span class="math inline">n</span>, <span class="math inline">X\gets X \cup \{x+s_i|x\in X\}</span>.</li>
<li>Return <span class="math inline">X</span></li>
</ol>
<p>The running time is <span class="math inline">O(|S||X|)</span>, where <span class="math inline">X</span> is the final output, since <span class="math inline">\{x+s_i|x\in X\}</span> is a shift, and union is just a sum. Using circshift, it can produce a output sensitive algorithm for subset sums in finite abelian groups.</p>

</div>
<div class="hide-on-print">
    <div class="info">Posted by <a href="https://chaoxuprime.com">Chao Xu</a> on 2015-04-22. </div>
    <div class="info">Tags: .</div>

</div>
      </article>
    </main>
    <footer class="hide-on-print">Â© 2010 - <time><script>document.write(new Date().getFullYear())</script></time> <a href="https://chaoxuprime.com">Chao Xu</a>. Licensed under <a href="http://www.wtfpl.net/txt/copying/">WTFPL v2</a> unless otherwise specified. <a href="/README.html">Blog README</a>.</footer>
  </body>
</html>
